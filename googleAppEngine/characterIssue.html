<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>汉字编码问题</title>
		<meta http-equiv="content-type" content="text/html; charset=GBK" />   
		<link type="text/css" rel="stylesheet" href="stylesheets/main.css" />
		<link type="text/css" rel="stylesheet" href="stylesheets/chengming.css" />
		<meta name="description" content="google app engine中中文编码问题的分析和解决方案" />
		<meta name="keywords" content="goole app engine,gae,编码,中文" />
    </head>
	<body>
		<p><a href="/">首页</a>|<a href="/guestbook">guest book</a>|<a href="/zhugechengming/cheng">诸葛亮称命法</a>|<a href="/DevNotes.html">开发手记</a></p>
		<h1>汉字编码问题</h1>
		<p>
		和所有的web应用一样，GAE也面临中文编码的转换问题，这个问题困扰了我一天半，终于在2009-2-4我把它解决了。GAE的web框架缺省的编码是utf-8，
		request和response都是，因为我设置了页面的编码是gbk，这导致了一系列的问题。<br />
		问题的产生是这样的：<br />
		一个http request进来，用request.get方法得到参数、数据，如果不指明编码方式，GAE就按照utf-8来处理，取出一个unicode字符串，但是request的实际
		编码方式可能不是utf-8，它是按照浏览器的设置来设定的，在firefox下，可以用查看->字符编码菜单进行查看和设置，如果不是utf-8的话，取到的数据
		就会出错了，制定request编码的语句是 request.charset='GBK'。<br />
		response也一样，如果不设定就会设置成utf-8，设置response编码的语句是 response.headers['Content-Type'] = 'text/html;charset=GBK'。<br />
		
		我现在的解决方案是每个请求和相应都设置charset='GBK'，这样比较繁琐，最好是遵守GAE的规则，都用utf-8，这样就清静了，但是这样要求源文件的编码也是utf-8，否则文件中的中文会变成乱码。
		</p>
		
		<p id="footer">Power by Google App Engine. CopyRight 2008 - 2010，杨贵堂。</p>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-7349754-1");
pageTracker._trackPageview();
} catch(err) {}</script>
    </body>
</html>